/*! For license information please see 31.aa38804b.chunk.js.LICENSE.txt */
(this["webpackJsonpstreamlit-browser"]=this["webpackJsonpstreamlit-browser"]||[]).push([[31],{1175:function(e,t,s){"use strict";s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return a}));var i=s(7),n=s.n(i);const a=n()("label",{target:"effi0qh0"})((({theme:e})=>({fontSize:e.fontSizes.smDefault,color:e.colors.bodyText,marginBottom:e.fontSizes.halfSmDefault})),""),l=n()("div",{target:"effi0qh1"})((({theme:e})=>({fontSize:e.fontSizes.smDefault,color:e.colors.gray,margin:e.spacing.none,textAlign:"right",position:"absolute",bottom:0,right:e.fontSizes.halfSmDefault})),"")},3993:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return re}));var i=s(0),n=s.n(i),a=s(142),l=s.n(a),r=s(37);let o,c;!function(e){e.ERROR="ERROR",e.DELETING="DELETING",e.READY="READY",e.UPLOADING="UPLOADING",e.UPLOADED="UPLOADED"}(o||(o={})),function(e){e.GigaByte="gb",e.KiloByte="kb",e.MegaByte="mb",e.Byte="b"}(c||(c={}));const d=Object(r.g)()?1024:1e3,g=[c.GigaByte,c.MegaByte,c.KiloByte,c.Byte],h=(e,t,s=1)=>{if(t||(t=c.Byte),s<0&&(s=0),e<0)throw new Error("Size must be greater than or equal to 0");const i=g.indexOf(t);return i&&e>d/2?h(e/d,g[i-1],s):"".concat(e.toFixed(s)).concat(t.toUpperCase())},m=(e,t,s)=>{if(e<0)throw Error("Size must be 0 or greater");const i=g.findIndex((e=>e===t)),n=g.findIndex((e=>e===s));if(-1===i||-1===n)throw Error("Unexpected byte unit provided");if(i===n)return e;const a=Math.abs(i-n),l=Math.pow(d,a);return i>n?e/l:e*l};var p=s(1175),f=s(38),u=s(6),x=s(2659),j=s.n(x),b=s(18),O=s(7),v=s.n(O);const S=v()("section",{target:"exg6vvm0"})((({isDisabled:e,theme:t})=>({display:"flex",alignItems:"center",padding:t.spacing.lg,backgroundColor:t.inSidebar?t.colors.white:t.colors.lightestGray,borderRadius:t.radii.md,":focus":{outline:"none",boxShadow:"0 0 0 1px ".concat(t.colors.primary)},color:e?t.colors.gray:t.colors.bodyText})),""),y=v()("div",{target:"exg6vvm1"})((({theme:e})=>({marginRight:"auto",alignItems:"center",display:"flex"})),""),D=v()("span",{target:"exg6vvm2"})((({theme:e})=>({color:e.colors.secondary,marginRight:e.spacing.lg})),""),E=v()("span",{target:"exg6vvm3"})((({theme:e})=>({marginBottom:e.spacing.twoXS})),""),z=v()("div",{target:"exg6vvm4"})({name:"j7qwjs",styles:"display:flex;flex-direction:column;"}),R=v()("div",{target:"exg6vvm5"})((({theme:e})=>({left:0,right:0,lineHeight:e.lineHeights.tight,paddingTop:e.spacing.md,paddingLeft:e.spacing.lg,paddingRight:e.spacing.lg})),""),w=v()("ul",{target:"exg6vvm6"})((({theme:e})=>({listStyleType:"none",marginBottom:0})),""),F=v()("li",{target:"exg6vvm7"})((({theme:e})=>({margin:e.spacing.none,padding:e.spacing.none})),""),B=v()("div",{target:"exg6vvm8"})((({theme:e})=>({display:"flex",alignItems:"baseline",flex:1,paddingLeft:e.spacing.lg,overflow:"hidden"})),""),M=v()("div",{target:"exg6vvm9"})((({theme:e})=>({marginRight:e.spacing.sm,marginBottom:e.spacing.twoXS,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})),""),A=v()("div",{target:"exg6vvm10"})((({theme:e})=>({display:"flex",alignItems:"center",marginBottom:e.spacing.twoXS})),""),k=v()("span",{target:"exg6vvm11"})((({theme:e})=>({marginRight:e.spacing.twoXS})),""),I=v()("div",{target:"exg6vvm12"})((({theme:e})=>({display:"flex",padding:e.spacing.twoXS,color:e.colors.secondary})),""),L=v()("small",{target:"exg6vvm13"})((({theme:e})=>({color:e.colors.danger,fontSize:e.fontSizes.smDefault,height:e.fontSizes.smDefault,lineHeight:e.fontSizes.smDefault,display:"flex",alignItems:"center",whiteSpace:"nowrap"})),""),N=v()("span",{target:"exg6vvm14"})({name:"0",styles:""}),U=e=>({[S]:{display:"flex",flexDirection:"column",alignItems:"flex-start"},[y]:{marginBottom:e.spacing.lg},[D]:{display:"none"},[R]:{paddingRight:e.spacing.lg},[A]:{maxWidth:"inherit",flex:1,alignItems:"flex-start",marginBottom:e.spacing.sm},[M]:{width:e.sizes.full},[B]:{flexDirection:"column"},[L]:{height:"auto",whiteSpace:"initial"},[N]:{display:"none"},[F]:{margin:e.spacing.none,padding:e.spacing.none}}),C=v()("div",{target:"exg6vvm15"})((({theme:e})=>e.inSidebar?U(e):{["@media (max-width: ".concat(e.breakpoints.sm,")")]:U(e)}),"");var P=s(1516),T=s(67);let G;!function(e){e.SECONDARY="secondary",e.DANGER="danger"}(G||(G={}));const Y=v()("small",{target:"euu6i2w0"})((({kind:e,theme:t})=>{const s=e===G.SECONDARY&&t.colors.secondary;return{color:e===G.DANGER&&t.colors.danger||s||t.colors.darkGray,fontSize:t.fontSizes.smDefault,height:t.fontSizes.smDefault,lineHeight:t.fontSizes.smDefault,display:"flex",alignItems:"center"}}),"");var X=s(1);var V=({multiple:e,acceptedExtensions:t,maxSizeBytes:s})=>Object(X.jsxs)(y,{children:[Object(X.jsx)(D,{children:Object(X.jsx)(T.a,{content:P.CloudUpload,size:"threeXL"})}),Object(X.jsxs)(z,{children:[Object(X.jsxs)(E,{children:["Drag and drop file",e?"s":""," here"]}),Object(X.jsxs)(Y,{children:["Limit ".concat(h(s,c.Byte,0)," per file"),t.length?" \u2022 ".concat(t.join(", ").replace(/\./g,"").toUpperCase()):null]})]})]});var q=({onDrop:e,multiple:t,acceptedExtensions:s,maxSizeBytes:i,disabled:n})=>Object(X.jsx)(j.a,{onDrop:e,multiple:t,accept:s.length?s:void 0,maxSize:i,disabled:n,children:({getRootProps:e,getInputProps:a})=>Object(X.jsxs)(S,Object(u.a)(Object(u.a)({},e()),{},{"data-testid":"stFileUploadDropzone",isDisabled:n,children:[Object(X.jsx)("input",Object(u.a)({},a())),Object(X.jsx)(V,{multiple:t,acceptedExtensions:s,maxSizeBytes:i}),Object(X.jsx)(b.c,{kind:b.a.PRIMARY,disabled:n,size:b.b.SMALL,children:"Browse files"})]}))}),H=s(52),J=s(131),K=s(77),W=s.n(K);const Q=v()("div",{target:"e1f8s2qs0"})((({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between",paddingBottom:e.spacing.twoXS,marginBottom:e.spacing.twoXS})),""),Z=v()("div",{target:"e1f8s2qs1"})((({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",color:e.colors.secondary})),"");var $=({className:e,currentPage:t,totalPages:s,onNext:i,onPrevious:n})=>Object(X.jsxs)(Q,{className:e,children:[Object(X.jsx)(Y,{children:"Showing page ".concat(t," of ").concat(s)}),Object(X.jsxs)(Z,{children:[Object(X.jsx)(b.c,{onClick:n,kind:b.a.MINIMAL,children:Object(X.jsx)(T.a,{content:P.ChevronLeft,size:"xl"})}),Object(X.jsx)(b.c,{onClick:i,kind:b.a.MINIMAL,children:Object(X.jsx)(T.a,{content:P.ChevronRight,size:"xl"})})]})]});const _=(e,t)=>Math.ceil(e.length/t);var ee=e=>W()((t=>{let s=t.pageSize,n=t.items,a=t.resetOnAdd,l=Object(J.a)(t,["pageSize","items","resetOnAdd"]);const r=Object(i.useState)(0),o=Object(H.a)(r,2),c=o[0],d=o[1],g=Object(i.useState)(_(n,s)),h=Object(H.a)(g,2),m=h[0],p=h[1],f=(e=>{const t=Object(i.useRef)();return Object(i.useEffect)((()=>{t.current=e}),[e]),t.current})(n);Object(i.useEffect)((()=>{f&&f.length!==n.length&&p(_(n,s)),f&&f.length<n.length?a&&d(0):c+1>=m&&d(m-1)}),[n,c,s,f,a,m]);const x=n.slice(c*s,c*s+s);return Object(X.jsxs)(X.Fragment,{children:[Object(X.jsx)(e,Object(u.a)({items:x},l)),n.length>s?Object(X.jsx)($,{className:"streamlit-paginator",pageSize:s,totalPages:m,currentPage:c+1,onNext:()=>{d(Math.min(c+1,m-1))},onPrevious:()=>{d(Math.max(0,c-1))}}):null]})}),e),te=s(224);const se=({file:e,progress:t})=>t?Object(X.jsx)(te.b,{value:t,size:te.a.SMALL,overrides:{Bar:{style:{marginLeft:0,marginTop:"4px"}}}}):e.status===o.ERROR?Object(X.jsxs)(L,{children:[Object(X.jsx)(k,{"data-testid":"stUploadedFileErrorMessage",children:e.errorMessage||"error"}),Object(X.jsx)(N,{children:Object(X.jsx)(T.a,{content:P.Error,size:"lg"})})]}):e.status===o.UPLOADED?Object(X.jsx)(Y,{kind:G.SECONDARY,children:h(e.size,c.Byte)}):e.status===o.DELETING?Object(X.jsx)(Y,{kind:G.SECONDARY,children:"Removing file"}):null;var ie=({file:e,progress:t,onDelete:s})=>Object(X.jsxs)(A,{className:"uploadedFile",children:[Object(X.jsx)(I,{children:Object(X.jsx)(T.a,{content:P.InsertDriveFile,size:"twoXL"})}),Object(X.jsxs)(B,{className:"uploadedFileData",children:[Object(X.jsx)(M,{className:"uploadedFileName",title:e.name,children:e.name}),Object(X.jsx)(se,{file:e,progress:t})]}),Object(X.jsx)("div",{"data-testid":"fileDeleteBtn",children:Object(X.jsx)(b.c,{onClick:()=>s(e.id||""),kind:b.a.MINIMAL,children:Object(X.jsx)(T.a,{content:P.Clear,size:"lg"})})})]});const ne=ee((({items:e,onDelete:t})=>Object(X.jsx)(w,{children:e.map((e=>Object(X.jsx)(F,{children:Object(X.jsx)(ie,{file:e,progress:e.progress,onDelete:t})},e.id)))})));var ae=e=>Object(X.jsx)(R,{children:Object(X.jsx)(ne,Object(u.a)({},e))});class le extends n.a.PureComponent{constructor(e){super(e),this.componentDidUpdate=e=>{e.disabled!==this.props.disabled&&this.props.disabled&&this.reset();const t=this.props.element.maxUploadSizeMb;e.element.maxUploadSizeMb!==t&&this.setState({maxSizeBytes:m(t,c.MegaByte,c.Byte)})},this.reset=()=>{this.setState({status:o.READY,errorMessage:void 0,files:[]})},this.dropHandler=(e,t)=>{const s=this.props.element.multipleFiles;if(s?this.setState((t=>({numValidFiles:t.numValidFiles+e.length}))):(this.state.files.length>0&&this.removeFile(this.state.files[0].id||""),this.setState({numValidFiles:1})),e.map(this.uploadFile),t.length>1&&!s){const s=t.findIndex((e=>1===e.errors.length&&"too-many-files"===e.errors[0].code));if(s>=0){const i=t[s];this.uploadFile(i.file,e.length),this.rejectFiles([...t.slice(0,s),...t.slice(s+1)])}else this.rejectFiles(t)}else this.rejectFiles(t)},this.handleFile=(e,t)=>(e.id="".concat(t).concat((new Date).getTime()),e.cancelToken=l.a.CancelToken.source(),this.setState((t=>({files:[e,...t.files]}))),e),this.uploadFile=(e,t)=>{e.progress=1,e.status=o.UPLOADING;const s=this.handleFile(e,t);this.props.uploadClient.uploadFiles(this.props.element.id,[s],this.state.numValidFiles,(e=>this.onUploadProgress(e,s.id)),s.cancelToken?s.cancelToken.token:l.a.CancelToken.source().token,!this.props.element.multipleFiles).then((()=>{this.setState((t=>({files:t.files.map((t=>e.id===t.id?(delete e.progress,delete e.cancelToken,e.status=o.UPLOADED,e):t))})))})).catch((e=>{l.a.isCancel(e)||this.setError(e?e.toString():"Unknown error")}))},this.rejectFiles=e=>{e.forEach(((e,t)=>{Object.assign(e.file,{status:o.ERROR,errorMessage:this.getErrorMessage(e.errors[0].code,e.file)}),this.handleFile(e.file,t)}))},this.getErrorMessage=(e,t)=>{switch(e){case"file-too-large":return"File must be ".concat(h(this.state.maxSizeBytes,c.Byte)," or smaller.");case"file-invalid-type":return"".concat(t.type," files are not allowed.");case"file-too-small":return"File size is too small.";case"too-many-files":return"Only one file is allowed.";default:return"Unexpected error. Please try again."}},this.setError=e=>{this.setState({status:o.ERROR,errorMessage:e})},this.delete=e=>{const t=this.state.files.find((t=>t.id===e));if(e&&t){if(t.errorMessage)return void this.removeFile(e);t.cancelToken&&t.cancelToken.cancel(),this.props.uploadClient.delete(this.props.element.id,e),this.removeFile(e)}else this.setError("File not found. Please try again.")},this.removeFile=e=>{this.setState((t=>{const s=t.files.filter((t=>t.id!==e)),i=t.files.length-s.length;return{status:s.length>0?o.UPLOADED:o.READY,errorMessage:void 0,files:s,numValidFiles:t.numValidFiles-i}}))},this.onUploadProgress=(e,t)=>{const s=Math.round(100*e.loaded/e.total),i=this.state.files.find((e=>e.id===t));i&&i.progress!==s&&(i.progress=s,this.setState((e=>({files:e.files.map((e=>e.id===t?i:e))}))))},this.render=()=>{const e=this.state,t=e.maxSizeBytes,s=e.errorMessage,i=e.files,n=this.props,a=n.element,l=n.disabled,r=a.type;return Object(X.jsxs)(C,{"data-testid":"stFileUploader",children:[Object(X.jsx)(p.b,{children:a.label}),s?Object(X.jsx)(f.b,{kind:f.a.ERROR,children:s}):null,Object(X.jsx)(q,{onDrop:this.dropHandler,multiple:a.multipleFiles,acceptedExtensions:r,maxSizeBytes:t,disabled:l}),Object(X.jsx)(ae,{items:[...i],pageSize:3,onDelete:this.delete,resetOnAdd:!0})]})};const t=e.element.maxUploadSizeMb;this.state={status:"READY",errorMessage:void 0,files:[],maxSizeBytes:m(t,c.MegaByte,c.Byte),numValidFiles:0}}}var re=le}}]);
//# sourceMappingURL=31.aa38804b.chunk.js.map